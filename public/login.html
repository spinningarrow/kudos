<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Kudos - Login</title>

		<link rel="stylesheet" href="lib/normalize.css/normalize.css">
		<link rel="stylesheet" href="css/main.css">

		<script src="lib/jquery/dist/jquery.js"></script>
		<script src="dpd.js"></script>
		<script src="js/app.js"></script>

		<script src="lib/react/react.js"></script>
		<script src="lib/react/JSXTransformer.js"></script>
	</head>
	<body>
		<h1>Kudos - deployd</h1>
		<main class="main-content"></main>

		<script type="text/jsx">
			var LoginForm = React.createClass({

				handleSubmit: function (event) {
					event.preventDefault();

					var username = this.refs.username.getDOMNode().value.trim();
					var password = this.refs.password.getDOMNode().value.trim();

					if (!username || !password) {
						return;
					}

					// Log the user in
					dpd.users.login({
						username: username,
						password: password
					}, function (result, error) {
						if (!error) {
							location.href = 'data.html';
							return;
						}

						console.log('Login error', error);
					});

					this.refs.username.getDOMNode().value = '';
					this.refs.password.getDOMNode().value = '';

					return;
				},

				render: function () {
					return (
						<form className="login-form" onSubmit={this.handleSubmit}>
							<input type="text" placeholder="Username" required ref="username" />
							<input type="password" placeholder="Password" required ref="password" />
							<button type="submit">Sign In</button>
						</form>
					);
				}
			});

			React.render(<LoginForm />, document.querySelector('main'));
		</script>
	</body>
</html>
